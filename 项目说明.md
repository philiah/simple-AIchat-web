# 项目文件说明和运行指南

## 📁 项目文件结构

```
简单网页/
├── app.py                 # 后端服务器（Flask应用）
├── requirements.txt       # Python依赖包列表
├── env.example            # 环境变量配置示例
├── .env                   # 环境变量配置文件（需要创建）
├── setup_venv.ps1         # 虚拟环境设置脚本（可选）
├── templates/             # HTML模板文件夹
│   └── index.html         # 前端聊天界面
└── static/                # 静态资源文件夹
    ├── style.css          # 样式文件
    └── script.js          # 前端交互逻辑
```

---

## 📄 每个文件的作用

### 🔧 后端文件

#### `app.py` - **后端服务器主文件**
- **作用**：Flask Web服务器，处理所有后端逻辑
- **功能**：
  - 提供网页服务（`/` 路由返回聊天界面）
  - 处理AI对话请求（`/api/chat` 路由）
  - 调用AI API并返回结果
  - 错误处理和响应管理
- **运行方式**：直接运行此文件启动服务器

#### `requirements.txt` - **Python依赖包列表**
- **作用**：列出项目所需的所有Python包
- **包含**：
  - `Flask` - Web框架
  - `flask-cors` - 跨域支持
  - `requests` - HTTP请求库
  - `python-dotenv` - 环境变量管理
- **使用**：`pip install -r requirements.txt` 安装所有依赖

#### `env.example` - **环境变量配置示例**
- **作用**：展示需要配置的环境变量格式
- **内容**：API密钥、API地址、模型名称的示例

#### `.env` - **环境变量配置文件**（需要创建）
- **作用**：存储实际的API配置信息（不会提交到Git）
- **创建方法**：复制 `env.example` 并重命名为 `.env`，然后填入真实值
- **格式**：
  ```
  AI_API_KEY=你的API密钥
  AI_API_URL=https://api.openai.com/v1/chat/completions
  AI_MODEL=gpt-3.5-turbo
  ```

---

### 🎨 前端文件

#### `templates/index.html` - **聊天界面HTML**
- **作用**：定义聊天界面的结构和布局
- **包含**：
  - 聊天容器
  - 消息输入框
  - 发送按钮
  - 字符计数显示
- **特点**：使用Flask模板语法引用CSS和JS文件

#### `static/style.css` - **样式文件**
- **作用**：美化聊天界面
- **功能**：
  - 渐变背景设计
  - 消息气泡样式（用户消息紫色，AI消息白色）
  - 响应式布局（支持手机和电脑）
  - 加载动画效果
  - 输入框和按钮样式

#### `static/script.js` - **前端交互逻辑**
- **作用**：处理用户交互和API调用
- **功能**：
  - 发送消息到后端
  - 显示用户消息和AI回复
  - 显示加载动画
  - 处理错误提示
  - 自动调整输入框高度
  - 回车发送、Shift+Enter换行
  - 字符计数

---

### 🛠️ 辅助文件

#### `setup_venv.ps1` - **虚拟环境设置脚本**（可选）
- **作用**：自动创建虚拟环境并安装依赖
- **使用**：在PowerShell中运行 `.\setup_venv.ps1`

---

## 🚀 如何运行项目

### 第一步：安装依赖

在项目目录打开终端（PowerShell），运行：

```powershell
pip install -r requirements.txt
```

### 第二步：配置API密钥

1. **创建 `.env` 文件**：
   - 复制 `env.example` 文件
   - 重命名为 `.env`（注意前面有点）

2. **编辑 `.env` 文件**，填入你的API配置：
   ```
   AI_API_KEY=sk-your-api-key-here
   AI_API_URL=https://api.openai.com/v1/chat/completions
   AI_MODEL=gpt-3.5-turbo
   ```

### 第三步：运行服务器

在项目目录运行：

```powershell
python app.py
```

看到以下输出说明启动成功：
```
 * Running on http://0.0.0.0:5000
 * Running on http://127.0.0.1:5000
```

### 第四步：访问网页

在浏览器中打开：
- `http://localhost:5000`
- 或 `http://127.0.0.1:5000`

---

## 📝 运行流程说明

1. **用户操作**：
   - 在浏览器输入框中输入消息
   - 点击"发送"或按Enter键

2. **前端处理**（`script.js`）：
   - 获取用户输入
   - 发送POST请求到 `/api/chat`
   - 显示加载动画

3. **后端处理**（`app.py`）：
   - 接收用户消息
   - 读取 `.env` 中的API配置
   - 调用AI API（OpenAI等）
   - 返回AI回复

4. **前端显示**（`script.js`）：
   - 接收AI回复
   - 在聊天界面显示消息
   - 移除加载动画

---

## ⚠️ 常见问题

### 1. 无法解析导入 "flask"
- **原因**：PyCharm未识别Python解释器
- **解决**：在PyCharm中配置正确的Python解释器（File → Settings → Python Interpreter）

### 2. API密钥未配置错误
- **原因**：没有创建 `.env` 文件或配置不正确
- **解决**：按照第二步创建并配置 `.env` 文件

### 3. 端口被占用
- **原因**：5000端口已被其他程序使用
- **解决**：修改 `app.py` 最后一行，改为其他端口，如 `port=5001`

---

## 🎯 快速开始检查清单

- [ ] 已安装Python依赖（`pip install -r requirements.txt`）
- [ ] 已创建 `.env` 文件
- [ ] 已在 `.env` 中配置API密钥
- [ ] 已运行 `python app.py`
- [ ] 浏览器已打开 `http://localhost:5000`

完成以上步骤后，你就可以开始使用AI对话助手了！🎉

